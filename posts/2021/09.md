---
title: Cybozu Frontend Monthly
date: "2021-09-28T17:00:00+09:00"
slug: "2021-09"
connpass: ""
streamUrl: ""
no: 15
members:
  - name: "@koba04"
    link: https://twitter.com/koba04
  - name: "@__sakito__"
    link: https://twitter.com/__sakito__
  - name: "@shisama_"
    link: https://twitter.com/shisama_
  - name: "@nakajmg"
    link: https://twitter.com/nakajmg
  - name: "@b4h0_c4t"
    link: https://twitter.com/b4h0_c4t
  - name: "@__sosukesuzuki"
    link: https://twitter.com/__sosukesuzuki
  - name: "@mugi_uno"
    link: https://twitter.com/mugi_uno
  - name: "@sajikix"
    link: https://twitter.com/sajikix
guest:
  - name: "@nabeliwo"
    link: https://twitter.com/nabeliwo
  - name: "@zoshigayan"
    link: https://twitter.com/zoshigayan
---

## [JavaScript eventing deep dive](https://web.dev/eventing-deepdive/)

- 共有者: b4h0_c4t

`preventDefault` や `stopPropagation` が何をしているのかを解説している記事。
いずれも主にイベントバブリング周りで用いられることが多いメソッドですが、実際にこれらがどのような動作をしているのか気になったので読んでみました。

### イベントキャプチャーとイベントバブリングについて

イベントキャプチャーとイベントバブリングはどちらもイベントが DOM ツリーに伝搬していくことを指しますが、両者の違いはそれぞれがイベントをリッスンするタイミングにあります。

イベントハンドリングにはキャプチャーフェーズ、ターゲットフェーズ、バブリングフェーズの 3 つの段階があります。

例えば、イベントがディスパッチされた際には `window` からイベントターゲットへ向かって DOM ツリーを下るようにイベントが起動していきます。
このようにイベントターゲットから下向きにイベントが適用されていく段階がキャプチャーフェーズと呼ばれます。
DOM ツリーを降り切った後、イベントターゲットとなる DOM にてイベントが発火する段階をターゲットフェーズと呼びます。
最後にイベントターゲットから `window` に向かって DOM ツリーを登るようにイベントが起動します。これがバブリングフェーズです。

開発者は addEventListener の第 3 引数等で、キャプチャーフェーズとバブリングフェーズのどちらでイベントを認識するか設定をすることができます。

### event.stopPropagation と event.preventDefault

`stopPropagation` は呼び出された時点以降のイベントが伝搬するのを停止させます。
例えばキャプチャーフェーズでこれが呼び出された場合、それ以降のキャプチャーフェーズとターゲットフェーズ、バブリングフェーズに登録されたイベントは一切発火しなくなります。

一方、`preventDefault` はイベントが持つデフォルトの挙動を抑制します。
例えば、 `<a>` タグのクリックイベントには `href` 属性で指定された URL へページ遷移をする挙動が含まれますが、 `preventDefault` を呼び出すことでその動作を抑制できます。(元記事では他にもいくつかのわかりやすい例が書かれているのでより詳細に知りたい方は見ることをお勧めします。)

これらのことから、`stopPropagation` と `preventDefault` は不審な挙動の解決策としてよく同列に扱われる一方で、それぞれ全く別の用途であることが理解できると思います。
どちらもイベントハンドリングの挙動に関して何かを抑制する挙動をしていますが、実際に抑制されるものは全くの別物なので今後扱う場面があった場合には念頭におきたいですね。

---
